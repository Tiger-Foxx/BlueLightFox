# FoxyBlueLight

![FoxyBlueLight Logo](https://github.com/Tiger-Foxx/BlueLightFox/raw/main/FoxyBlueLight/Resources/logo.png)

## Protection avanc√©e des yeux contre la lumi√®re bleue pour Windows

[![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)](https://github.com/Tiger-Foxx/BlueLightFox/releases)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![.NET](https://img.shields.io/badge/.NET-8.0-purple.svg)](https://dotnet.microsoft.com/download/dotnet/8.0)

**FoxyBlueLight** est une application de filtrage de lumi√®re bleue sophistiqu√©e pour Windows, con√ßue pour r√©duire la fatigue oculaire lors de l'utilisation prolong√©e d'√©crans. L'application propose plusieurs modes de filtrage, des options de personnalisation avanc√©es et une interface utilisateur moderne d√©velopp√©e avec WPF et MaterialDesign.

![Screenshot](https://github.com/Tiger-Foxx/BlueLightFox/raw/main/Screenshots/main-interface.png)

## üìã Table des mati√®res

- [Fonctionnalit√©s](#fonctionnalit√©s)
- [Installation](#installation)
- [Utilisation](#utilisation)
- [Architecture technique](#architecture-technique)
- [Impl√©mentation des filtres](#impl√©mentation-des-filtres)
- [Personnalisation](#personnalisation)
- [Performances et consid√©rations](#performances-et-consid√©rations)
- [D√©pendances](#d√©pendances)
- [Contribution](#contribution)
- [Licence](#licence)
- [Remerciements](#remerciements)

## ‚ú® Fonctionnalit√©s

### Filtres avanc√©s de lumi√®re bleue
- **Multi-mode**: Temp√©rature, Chaud, Tr√®s chaud, S√©pia, Niveaux de gris, Rouge nuit et Mode personnalis√©
- **Ajustement de la temp√©rature de couleur**: De 1900K √† 6500K pour une adaptation pr√©cise
- **Personnalisation RGB**: Contr√¥le exact des composantes Rouge, Vert et Bleu en mode personnalis√©
- **S√©lecteurs de couleurs pr√©d√©finies**: Choix rapide parmi des teintes √©prouv√©es pour le confort visuel

### Techniques de filtrage multiples
- **Mode Gamma**: Ajustement traditionnel des courbes gamma pour une modification pr√©cise des couleurs
- **Mode Superposition douce**: Filtre transparent qui pr√©serve mieux les couleurs d'origine (similaire √† Windows Night Light)
- **Mode Pr√©servation de luminosit√©**: R√©duction de la lumi√®re bleue tout en maintenant la luminosit√© per√ßue

### Interface utilisateur
- **Design moderne Material Design**: Interface √©l√©gante et intuitive
- **Options de personnalisation avanc√©es**: Intensit√©, luminosit√© et transparence ajustables
- **Fen√™tre redimensionnable**: S'adapte √† vos pr√©f√©rences d'affichage
- **Ic√¥ne dans la barre des t√¢ches**: Acc√®s rapide aux fonctions essentielles

### Programmation et automatisation
- **Activation programm√©e**: Configuration des heures d'activation et de d√©sactivation automatiques
- **Sauvegarde des param√®tres**: Restauration de vos pr√©f√©rences au red√©marrage

## üíª Installation

### Pr√©requis
- Windows 10 ou Windows 11
- Droits d'administrateur pour l'installation (n√©cessaire pour modifier les param√®tres d'affichage)

### M√©thodes d'installation

#### Installeur standard
1. T√©l√©chargez le dernier installateur depuis la [page des versions](https://github.com/Tiger-Foxx/BlueLightFox/releases)
2. Ex√©cutez `FoxyBlueLightSetup.exe`
3. Suivez les instructions d'installation
4. S√©lectionnez "Ex√©cuter au d√©marrage" si vous souhaitez que l'application d√©marre automatiquement

#### Fichier ex√©cutable portable
1. T√©l√©chargez `FoxyBlueLight-Portable.zip` depuis la [page des versions](https://github.com/Tiger-Foxx/BlueLightFox/releases)
2. Extrayez l'archive vers n'importe quel dossier
3. Ex√©cutez `FoxyBlueLight.exe`

#### Compilation depuis la source
1. Clonez ce d√©p√¥t: `git clone https://github.com/Tiger-Foxx/BlueLightFox.git`
2. Ouvrez la solution dans Visual Studio 2022 ou JetBrains Rider
3. Restaurez les packages NuGet
4. Compilez le projet en mode Release
5. L'ex√©cutable se trouve dans le dossier `bin/Release/net8.0-windows`

## üöÄ Utilisation

### D√©marrage rapide
1. Lancez FoxyBlueLight depuis le menu D√©marrer ou le bureau
2. Utilisez l'interrupteur principal en haut pour activer/d√©sactiver le filtre
3. S√©lectionnez un mode de filtre dans la liste d√©roulante
4. Ajustez l'intensit√© selon vos pr√©f√©rences

### Modes de filtrage
- **Temp√©rature**: Ajustez la temp√©rature de couleur de 1900K (tr√®s chaud) √† 6500K (neutre)
- **Chaud**: Teinte orang√©e l√©g√®re pour une utilisation quotidienne
- **Tr√®s chaud**: Teinte orang√©e plus prononc√©e pour le soir
- **S√©pia**: Mode lecture avec teinte s√©pia pour r√©duire la fatigue oculaire lors de la lecture
- **Niveaux de gris**: Retire toutes les couleurs pour un mode monochrome
- **Rouge nuit**: Mode de vision nocturne pr√©servant la vision dans l'obscurit√©
- **Personnalis√©**: D√©finissez vos propres valeurs RGB pour un contr√¥le total

### Types d'att√©nuation
- **Gamma (Standard)**: Modifie directement les courbes gamma du syst√®me d'affichage
- **Superposition douce**: Ajoute une couche de couleur semi-transparente sur l'√©cran, permettant des ajustements plus subtils
- **Luminosit√© pr√©serv√©e**: Mode sp√©cial qui r√©duit la lumi√®re bleue tout en maintenant la luminosit√© per√ßue

### Planification
1. Activez l'option "Activation programm√©e"
2. D√©finissez une heure d'activation (g√©n√©ralement le soir)
3. D√©finissez une heure de d√©sactivation (g√©n√©ralement le matin)
4. FoxyBlueLight s'activera et se d√©sactivera automatiquement aux heures sp√©cifi√©es

### Raccourcis et fonctionnalit√©s rapides
- **Ic√¥ne de la barre des t√¢ches**: Clic droit pour acc√©der aux options rapides
- **Double-clic sur l'ic√¥ne**: Affiche/masque l'interface principale
- **Bouton "Appliquer"**: Enregistre et applique imm√©diatement les modifications
- **Bouton "Restaurer √©cran"**: D√©sactive temporairement le filtre sans perdre vos r√©glages

## üèóÔ∏è Architecture technique

FoxyBlueLight suit le pattern d'architecture MVVM (Model-View-ViewModel) pour s√©parer clairement la logique m√©tier, l'interface utilisateur et la logique de pr√©sentation.

### Structure du projet
```
FoxyBlueLight/
‚îú‚îÄ‚îÄ Models/                     # Mod√®les de donn√©es
‚îÇ   ‚îú‚îÄ‚îÄ FilterSettings.cs       # Param√®tres du filtre
‚îÇ   ‚îî‚îÄ‚îÄ ColorInfo.cs            # Informations sur les couleurs pr√©d√©finies
‚îú‚îÄ‚îÄ ViewModels/                 # ViewModels (logique de pr√©sentation)
‚îÇ   ‚îî‚îÄ‚îÄ MainViewModel.cs        # ViewModel principal
‚îú‚îÄ‚îÄ Views/                      # Vues (interfaces utilisateur)
‚îÇ   ‚îú‚îÄ‚îÄ ModernWidget.xaml       # Interface principale
‚îÇ   ‚îú‚îÄ‚îÄ SplashScreen.xaml       # √âcran de d√©marrage
‚îÇ   ‚îî‚îÄ‚îÄ ColorSelector.xaml      # S√©lecteur de couleurs personnalis√©
‚îú‚îÄ‚îÄ Services/                   # Services m√©tier
‚îÇ   ‚îî‚îÄ‚îÄ FilterService.cs        # Service de filtrage d'√©cran
‚îú‚îÄ‚îÄ Native/                     # API natives et interop√©ration
‚îÇ   ‚îî‚îÄ‚îÄ DisplayAPI.cs           # API de gestion d'affichage Windows
‚îú‚îÄ‚îÄ Styles/                     # Styles et ressources XAML
‚îÇ   ‚îî‚îÄ‚îÄ ModernSliders.xaml      # Style personnalis√© pour les sliders
‚îî‚îÄ‚îÄ Resources/                  # Ressources (images, ic√¥nes)
    ‚îî‚îÄ‚îÄ logo.png                # Logo de l'application
```

### Composants principaux

#### Models
- **FilterSettings**: Contient tous les param√®tres configurables du filtre (mode, intensit√©, temp√©rature, multiplicateurs RGB, planification)
- **ColorInfo**: Repr√©sente une couleur pr√©d√©finie avec son nom et sa valeur hexad√©cimale

#### ViewModels
- **MainViewModel**: G√®re l'√©tat de l'application, les commandes utilisateur et la coordination entre l'interface et le service de filtrage

#### Views
- **ModernWidget**: Interface principale avec tous les contr√¥les
- **SplashScreen**: √âcran de d√©marrage anim√©
- **ColorSelector**: Contr√¥le personnalis√© pour la s√©lection visuelle des couleurs

#### Services
- **FilterService**: Impl√©mente les diff√©rentes techniques de filtrage (gamma, overlay, pr√©servation de luminosit√©)

#### Native
- **DisplayAPI**: Wrapper pour les API Windows de gestion des couleurs d'affichage

## üî¨ Impl√©mentation des filtres

### Mode Gamma (Traditionnel)

Le mode Gamma utilise l'API Win32 `SetDeviceGammaRamp` pour modifier directement les courbes gamma de la carte graphique. Cette m√©thode permet un ajustement pr√©cis des couleurs mais peut parfois cr√©er des effets ind√©sirables sur certaines nuances.

```csharp
// Extrait de code: Cr√©ation d'une rampe gamma
RAMP ramp = new RAMP
{
    Red = new ushort[256],
    Green = new ushort[256],
    Blue = new ushort[256]
};

// Calcul des valeurs de la rampe
for (int i = 0; i < 256; i++)
{
    double value = i / 255.0;
    double correctedValue = Math.Pow(value, 1.0 / 2.2); // Gamma 2.2
    
    ramp.Red[i] = (ushort)(correctedValue * redMultiplier * 65535.0);
    ramp.Green[i] = (ushort)(correctedValue * greenMultiplier * 65535.0);
    ramp.Blue[i] = (ushort)(correctedValue * blueMultiplier * 65535.0);
}

// Application de la rampe
SetDeviceGammaRamp(hDC, ref ramp);
```

### Mode Superposition douce

Ce mode cr√©e une fen√™tre WPF transparente qui recouvre l'√©cran entier avec une couleur semi-transparente. Cette approche permet:
- Des ajustements plus subtils
- Une transition plus douce entre les √©tats
- Une meilleure pr√©servation des couleurs d'origine

La fen√™tre est rendue "transparente aux clics" gr√¢ce √† l'utilisation des styles de fen√™tre avanc√©s de Win32, permettant √† l'utilisateur d'interagir normalement avec les applications sous-jacentes.

```csharp
// Extrait de code: Cr√©ation d'une fen√™tre d'overlay
_overlayWindow = new Window
{
    WindowStyle = WindowStyle.None,
    AllowsTransparency = true,
    Background = Brushes.Transparent,
    Topmost = true,
    WindowState = WindowState.Maximized,
    ShowInTaskbar = false,
    ResizeMode = ResizeMode.NoResize,
    IsHitTestVisible = false
};

// Rendre la fen√™tre transparente aux clics
IntPtr hwnd = new WindowInteropHelper(_overlayWindow).Handle;
int extendedStyle = GetWindowLong(hwnd, GWL_EXSTYLE);
SetWindowLong(hwnd, GWL_EXSTYLE, extendedStyle | WS_EX_TRANSPARENT);
```

### Mode Pr√©servation de luminosit√©

Cette technique avanc√©e utilise une formule sp√©ciale pour r√©duire la lumi√®re bleue tout en pr√©servant la perception de luminosit√©. Elle s'inspire des algorithmes utilis√©s dans f.lux et d'autres applications professionnelles de filtrage de lumi√®re bleue.

```csharp
// Extrait de code: Calcul pr√©servant la luminosit√©
double avgMultiplier = (redMultiplier + greenMultiplier + blueMultiplier) / 3.0;
double brightnessAdjust = settings.Brightness * (1.0 / avgMultiplier);

for (int i = 0; i < 256; i++)
{
    double normalizedValue = i / 255.0;
    
    double redAdjusted = Math.Pow(normalizedValue, 1.0 / redMultiplier) * redMultiplier * brightnessAdjust;
    double greenAdjusted = Math.Pow(normalizedValue, 1.0 / greenMultiplier) * greenMultiplier * brightnessAdjust;
    double blueAdjusted = Math.Pow(normalizedValue, 1.0 / blueMultiplier) * blueMultiplier * brightnessAdjust;
    
    // Appliquer l'intensit√© comme m√©lange
    redAdjusted = normalizedValue * (1.0 - intensity) + redAdjusted * intensity;
    // [... autres calculs]
}
```

### Conversion de temp√©rature de couleur

Le filtre de temp√©rature utilise une formule complexe pour convertir une valeur en Kelvin (de 1900K √† 6500K) vers des valeurs RGB √©quivalentes. Cette formule est bas√©e sur des recherches en colorim√©trie pour une reproduction pr√©cise des temp√©ratures de couleur.

```csharp
// Extrait de code: Conversion Kelvin vers RGB
private void GetColorForTemperature(int temp, out byte r, out byte g, out byte b)
{
    double temperature = temp / 100.0;
    double red, green, blue;
    
    if (temperature <= 66)
    {
        red = 255;
        green = 99.4708025861 * Math.Log(temperature) - 161.1195681661;
        
        if (temperature <= 19)
            blue = 0;
        else
            blue = 138.5177312231 * Math.Log(temperature - 10) - 305.0447927307;
    }
    else
    {
        red = 329.698727446 * Math.Pow(temperature - 60, -0.1332047592);
        green = 288.1221695283 * Math.Pow(temperature - 60, -0.0755148492);
        blue = 255;
    }
    
    r = (byte)Math.Max(0, Math.Min(255, red));
    g = (byte)Math.Max(0, Math.Min(255, green));
    b = (byte)Math.Max(0, Math.Min(255, blue));
}
```

## üé® Personnalisation

### Interface utilisateur

L'interface de FoxyBlueLight est construite avec WPF et utilise la biblioth√®que MaterialDesignInXAML pour un design moderne et √©l√©gant. L'interface prend en charge:

- Th√®me sombre pour √©viter l'√©blouissement
- Contr√¥les de mat√©riel design (sliders, boutons, toggles)
- Animations fluides pour une exp√©rience utilisateur agr√©able
- Disposition responsive qui s'adapte aux diff√©rentes tailles de fen√™tre
- S√©lecteurs de couleur visuels pour une s√©lection intuitive

### S√©lecteurs de couleur personnalis√©s

FoxyBlueLight impl√©mente un contr√¥le personnalis√© `ColorSelector` qui permet aux utilisateurs de s√©lectionner visuellement des couleurs pr√©d√©finies sous forme de cercles color√©s:

```xml
<!-- Extrait de XAML: S√©lecteur de couleur personnalis√© -->
<Button Width="36" Height="36" Margin="4" 
       Background="#FFE3B9"
       Command="{Binding SelectColorCommand}" 
       CommandParameter="#FFE3B9">
    <Button.Template>
        <ControlTemplate TargetType="Button">
            <Grid>
                <Ellipse Fill="{TemplateBinding Background}"/>
                <Ellipse x:Name="highlight" Stroke="White" StrokeThickness="0"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="highlight" Property="StrokeThickness" Value="2"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Button.Template>
</Button>
```

### Sliders personnalis√©s

Les sliders standard ont √©t√© remplac√©s par des sliders personnalis√©s avec un design moderne et une meilleure ergonomie:

```xml
<!-- Extrait de XAML: Style de slider personnalis√© -->
<Style x:Key="ModernSliderStyle" TargetType="Slider">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Slider">
                <Grid>
                    <!-- Track background -->
                    <Border Height="4" CornerRadius="2" Background="{TemplateBinding Background}" Margin="7,0"/>
                    
                    <!-- Thumb (curseur) personnalis√© avec animation au survol -->
                    <Track.Thumb>
                        <Thumb>
                            <Thumb.Template>
                                <ControlTemplate TargetType="Thumb">
                                    <Grid>
                                        <Ellipse x:Name="OuterCircle" Width="18" Height="18" Fill="#FF6700"/>
                                        <Ellipse Width="16" Height="16" Fill="White"/>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="OuterCircle" Property="Width" Value="20"/>
                                            <Setter TargetName="OuterCircle" Property="Height" Value="20"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Thumb.Template>
                        </Thumb>
                    </Track.Thumb>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
```

## ‚öôÔ∏è Performances et consid√©rations

### Optimisations de performance

FoxyBlueLight a √©t√© optimis√© pour utiliser un minimum de ressources syst√®me:

- **Faible empreinte m√©moire**: L'application utilise environ 30-40 MB de RAM
- **Charge CPU minimale**: Le filtrage utilise principalement les API graphiques mat√©rielles
- **Mode superposition efficace**: Utilise DirectComposition pour un rendu acc√©l√©r√© par le GPU
- **Mise en cache des param√®tres**: √âvite les recalculs inutiles lors des ajustements

### Gestion avanc√©e des √©v√©nements

Pour garantir une exp√©rience utilisateur fluide, l'application g√®re efficacement:

- Les changements de r√©solution d'√©cran
- Les connexions/d√©connexions de moniteurs
- La suspension/reprise du syst√®me
- Le changement d'utilisateur

### Compatibilit√© multi-√©crans

FoxyBlueLight supporte les configurations multi-√©crans:

```csharp
// Extrait de code: D√©tection et application sur tous les √©crans connect√©s
private void ApplyToAllScreens()
{
    // Obtenir les informations de tous les √©crans connect√©s
    foreach (var screen in System.Windows.Forms.Screen.AllScreens)
    {
        // Application sp√©cifique √† chaque √©cran si n√©cessaire
    }
    
    // Application du filtre au niveau syst√®me
    ApplyFilter(settings);
}
```

## üì¶ D√©pendances

FoxyBlueLight utilise les biblioth√®ques et technologies suivantes:

- **.NET 8.0**: Framework d'ex√©cution et biblioth√®ques de base
- **WPF (Windows Presentation Foundation)**: Framework d'interface utilisateur
- **MaterialDesignInXAML**: Biblioth√®que de composants UI Material Design
- **Win32 API**: Pour l'acc√®s aux fonctions syst√®me de gestion des couleurs d'affichage

## ü§ù Contribution

Les contributions au projet sont les bienvenues! Voici comment participer:

1. **Forker le d√©p√¥t**: `https://github.com/Tiger-Foxx/BlueLightFox`
2. **Cr√©er une branche**: `git checkout -b feature/ma-fonctionnalite`
3. **Valider vos modifications**: `git commit -am 'Ajout d'une fonctionnalit√©'`
4. **Pousser vers la branche**: `git push origin feature/ma-fonctionnalite`
5. **Ouvrir une Pull Request**

### Guidelines pour les contributions

- Suivre les conventions de codage C#/WPF standard
- Ajouter des commentaires pour le code complexe
- S'assurer que le code est test√© sur diff√©rentes versions de Windows
- Cr√©er des issues pour les bugs ou les suggestions de fonctionnalit√©s

## üìÑ Licence

Ce projet est sous licence MIT - voir le fichier [LICENSE](LICENSE) pour plus de d√©tails.

## üëè Remerciements

Ce logiciel a √©t√© inspir√© par plusieurs projets similaires:

- **f.lux**: Pionnier dans le domaine du filtrage de la lumi√®re bleue
- **Windows Night Light**: Pour les concepts d'int√©gration syst√®me
- **MaterialDesignInXAML**: Pour la magnifique biblioth√®que d'interface utilisateur

---

D√©velopp√© avec ‚ù§Ô∏è par TheTigerFox - ¬© 2025

---

*Note: FoxyBlueLight n'est pas un dispositif m√©dical et ne pr√©tend pas traiter, gu√©rir ou diagnostiquer des probl√®mes de sant√©. Consultez un professionnel de la sant√© si vous avez des pr√©occupations concernant votre vision ou votre sant√© oculaire.*